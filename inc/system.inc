

;####################################################################################
;####################################################################################
;#################################  PROGRAM START  ##################################
;####################################################################################
;####################################################################################

%macro PROGRAM_START 0

section .text
    global _main
    global _start
    
_main:
    ; C equivalent: function declaration and opening curley bracket
    ; of the beginning of the function:
    ; void main () {
    push    rbp         ; set up stack frame
                        ; here we are saving the _main base pointer
    mov     rbp, rsp    ; creating a new base stack by moving the 
                        ; stack pointer inside it
%endmacro

;####################################################################################
;####################################################################################
;##################################  PROGRAM END  ###################################
;####################################################################################
;####################################################################################

%macro PROGRAM_END 1

    ; C equivalent: closing curley bracket of ending function 
    ; }
    mov     rsp, rbp    ; restore main function pointer into the base pointer
    pop     rbp
 
    exit %1

%endmacro


;####################################################################################
;####################################################################################
;#################################  PROGRAM EXIT  ###################################
;####################################################################################
;####################################################################################

%macro exit 1
    mov rax, SYS_EXIT
    mov rdi, %1
    syscall
%endmacro


